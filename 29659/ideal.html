<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Fat Dog Game</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Protest+Guerrilla&family=Space+Grotesk:wght@300..700&display=swap"
    rel="stylesheet">
  <style>
    body {
      background: rgb(61, 61, 154);
      font-family: "Space Grotesk", sans-serif, Arial, sans-serif;
      font-weight: 400;
      font-style: normal;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 60vh;
      margin: 0;
    }

    .container h1 {
      font-size: 50px;
      font-weight: 700;
    }

    .btn-primary {
      background: #1b1b1b;
      border: none;
      padding: 10px 15px;
      color: white;
      cursor: pointer;
      border-radius: 5px;
      font-size: 1em;
    }

    .btn-primary:hover {
      background: #333;
    }

    #gameDuration {
      padding: 9px 10px;
      border-radius: 5px;
      border: 2px solid #333;
      background-color: #e0e0e0;
      color: #333;
      outline: none;
      cursor: pointer;
      transition: background-color 0.3s, border-color 0.3s;
    }

    #gameDuration:hover {
      background-color: #e0e0e0;
      border-color: #333;
    }

    #gameDuration:focus {
      border-color: #333;
      box-shadow: 0 0 8px rgba(33, 33, 34, 0.4);
    }


    #gameArea {
      background-color: #fff;
      color: #000;
      height: 50vh;
      width: 800px;
      position: relative;
      border: 3px solid #333;
      border-radius: 25px;
      overflow: hidden;
    }

    .lane {
      height: 100%;
      width: 50%;
      float: left;
    }

    .lane:nth-child(1) {
      border-right: 2px dashed #000;
    }

    #dog {
      position: absolute;
      bottom: 0;
      left: 25%;
      width: 80px;
      height: 80px;
      transition: left 0.3s, width 0.1s;
    }

    .option {
      width: 40px;
      height: 40px;
      color: #fff;
      position: absolute;
      text-align: center;
      line-height: 40px;
      background: #6b93d6;
      border-radius: 50%;
    }

    .score,
    .timer {
      position: absolute;
      top: 10px;
    }

    .score {
      right: 10px;
    }

    .timer {
      left: 10px;
    }
  </style>
</head>

<body>

  <div id="welcomeScreen" class="container">
    <h1>Fat Dog</h1>
    <p>Instructions: Use arrow keys to move the dog. Make the dog as fat as possible within the time limit!</p>
    <select id="gameDuration">
      <option value="5">5 seconds</option>
      <option value="30" selected>30 seconds</option>
      <option value="60">1 minute</option>
      <option value="600">10 minutes</option>
    </select>
    <button onclick="startGame()" class="btn btn-primary">Start Game</button>
  </div>

  <div id="gameArea" style="display:none;">
    <div class="lane" id="lane1"></div>
    <div class="lane" id="lane2"></div>
    <img id="dog" src='https://random.dog/ae9e4114-a21b-4d6b-8967-f400f80ca5ae.jpg' alt="Dog">

    <div>
      <div class="timer">Time Left: <span id="countdown"></span></div>
      <div class="score">Current Score: <span id="dogSize">80</span> | High Score: <span id="highScore">0</span>
      </div>
    </div>
  </div>

  <div id="gameOver" style="display:none;">
    <h2>Game Over!</h2>
    <p>Your Score: <span id="finalScore"></span></p>
    <button id="restartBtn" class="btn-primary" onclick="restartGame()">Restart</button>
  </div>

  <script>
    const gameArea = document.getElementById('gameArea');
    const dog = document.getElementById('dog');
    const dogSizeDisplay = document.getElementById('dogSize');
    const countdownDisplay = document.getElementById('countdown');
    let highScore = localStorage.getItem('highScore') || 0;
    let dogSize = 80;
    let lane = 1;
    let dogLane = 1;
    let gameInterval, fallInterval;
    let timeLeft;

    function updateHighScore() {
      document.getElementById('highScore').textContent = highScore;
    }

    function startGame() {
      document.getElementById('welcomeScreen').style.display = 'none';
      gameArea.style.display = 'block';
      timeLeft = document.getElementById('gameDuration').value;
      startTimer();
      spawnOptions();
    }

    function startTimer() {
      gameInterval = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
          countdownDisplay.textContent = timeLeft;
        } else {
          endGame();
        }
      }, 1000);
    }

    function spawnOptions() {
      let fallSpeed = 1;
      let fallSpeedMultiplier = 1.5;
      let maxFallSpeed = 5;

      fallInterval = setInterval(() => {
        if (Math.random() > 0.5) createOption(1);
        else createOption(2);

        // Increase fall speed
        fallSpeed = Math.min(fallSpeed * fallSpeedMultiplier, maxFallSpeed);
      }, 1000 / fallSpeed);
    }

    function createOption(lane) {
      const option = document.createElement('div');
      option.className = 'option';
      const operations = ['x2', '+10', '-5', '/2'];
      const operationIndex = Math.floor(Math.random() * operations.length);
      option.textContent = operations[operationIndex];
      option.style.top = '0px';
      option.style.left = lane === 1 ? '25%' : '75%';
      switch (operationIndex) {
        case 0:
          option.style.backgroundColor = '#ff9901';
          break;
        case 1:
          option.style.backgroundColor = '#32cd31';
          break;
        case 2:
          option.style.backgroundColor = '#ff0001';
          break;
        case 3:
          option.style.backgroundColor = '#0000fe';
          break;
      }
      gameArea.appendChild(option);

      let pos = 0;
      const fallSpeed = 2;
      const moveOption = setInterval(() => {
        if (pos < gameArea.offsetHeight - 40) {
          pos += fallSpeed;
          option.style.top = pos + 'px';
        } else {
          clearInterval(moveOption);
          gameArea.removeChild(option);

          if (lane === dogLane) applyEffect(option.textContent);
        }
      }, 10);
    }

    function applyEffect(e) {
      if (e.includes('x')) dogSize *= parseInt(e.slice(1));
      else if (e.includes('/')) dogSize /= parseInt(e.slice(1));
      else dogSize += parseInt(e);

      updateDogSize();
    }

    function updateDogSize() {
      const currentWidth = parseInt(dog.style.width);

      if (dogSize < 200 || dogSize < currentWidth) {
        dog.style.width = dogSize + 'px';
      }
      dogSizeDisplay.textContent = dogSize;

      if (dogSize <= 20) {
        endGame();
      }
    }

    function moveDog(direction) {
      if (direction === 'left' && dogLane === 2) {
        dogLane = 1;
        dog.style.left = '25%';
      } else if (direction === 'right' && dogLane === 1) {
        dogLane = 2;
        dog.style.left = '75%';
      }
    }

    function endGame() {
      clearInterval(gameInterval);
      clearInterval(fallInterval);

      gameArea.style.display = 'none';
      document.getElementById('restartBtn').style.display = 'block';
      document.getElementById('gameOver').style.display = 'block';
      document.getElementById('finalScore').textContent = dogSize; // Show final score

      if (dogSize > highScore) {
        highScore = dogSize;
        localStorage.setItem('highScore', highScore);
        updateHighScore();
      }
    }

    function restartGame() {
      clearInterval(gameInterval);
      clearInterval(fallInterval);

      dogSize = 80;
      lane = 1;

      document.getElementById('restartBtn').style.display = 'none';
      document.getElementById('gameOver').style.display = 'none';

      updateDogSize();
      startGame();
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') moveDog('left');
      else if (e.key === 'ArrowRight') moveDog('right');
    });

    updateHighScore();
  </script>

</body>

</html>